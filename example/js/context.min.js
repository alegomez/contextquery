!function(e){function r(e,r,t){e in l||(l[e]={name:e,declarative:!0,deps:r,declare:t,normalizedDeps:r})}function t(e){return p[e]||(p[e]={name:e,dependencies:[],exports:{},importers:[]})}function n(r){if(!r.module){var o=r.module=t(r.name),a=r.module.exports,u=r.declare.call(e,function(e,r){if(o.locked=!0,"object"==typeof e)for(var t in e)a[t]=e[t];else a[e]=r;for(var n=0,u=o.importers.length;u>n;n++){var i=o.importers[n];if(!i.locked)for(var l=0;l<i.dependencies.length;++l)i.dependencies[l]===o&&i.setters[l](a)}return o.locked=!1,r},r.name);o.setters=u.setters,o.execute=u.execute;for(var s=0,d=r.normalizedDeps.length;d>s;s++){var f,c=r.normalizedDeps[s],v=l[c],m=p[c];m?f=m.exports:v&&!v.declarative?f=v.esModule:v?(n(v),m=v.module,f=m.exports):f=i(c),m&&m.importers?(m.importers.push(o),o.dependencies.push(m)):o.dependencies.push(null),o.setters[s]&&o.setters[s](f)}}}function o(r){var t={};if(("object"==typeof r||"function"==typeof r)&&r!==e)if(d)for(var n in r)"default"!==n&&a(t,r,n);else{var o=r&&r.hasOwnProperty;for(var n in r)"default"===n||o&&!r.hasOwnProperty(n)||(t[n]=r[n])}return t.default=r,c(t,"__useDefault",{value:!0}),t}function a(e,r,t){try{var n;(n=Object.getOwnPropertyDescriptor(r,t))&&c(e,t,n)}catch(o){return e[t]=r[t],!1}}function u(r,t){var n=l[r];if(n&&!n.evaluated&&n.declarative){t.push(r);for(var o=0,a=n.normalizedDeps.length;a>o;o++){var d=n.normalizedDeps[o];-1==s.call(t,d)&&(l[d]?u(d,t):i(d))}n.evaluated||(n.evaluated=!0,n.module.execute.call(e))}}function i(e){if(m[e])return m[e];if("@node/"==e.substr(0,6))return m[e]=o(v(e.substr(6)));var r=l[e];if(!r)throw"Module "+e+" not present.";return n(l[e]),u(e,[]),l[e]=void 0,r.declarative&&c(r.module.exports,"__esModule",{value:!0}),m[e]=r.declarative?r.module.exports:r.esModule}var l={},s=Array.prototype.indexOf||function(e){for(var r=0,t=this.length;t>r;r++)if(this[r]===e)return r;return-1},d=!0;try{Object.getOwnPropertyDescriptor({a:0},"a")}catch(f){d=!1}var c;!function(){try{Object.defineProperty({},"a",{})&&(c=Object.defineProperty)}catch(e){c=function(e,r,t){try{e[r]=t.value||t.get.call(e)}catch(n){}}}}();var p={},v="undefined"!=typeof System&&System._nodeRequire||"undefined"!=typeof require&&require.resolve&&"undefined"!=typeof process&&require,m={"@empty":{}};return function(e,t,n,a){return function(u){u(function(u){for(l=0;l<t.length;l++)!function(e,r){r&&r.__esModule?m[e]=r:m[e]=o(r)}(t[l],arguments[l]);a({register:r});var s=i(e[0]);if(e.length>1)for(var l=1;l<e.length;l++)i(e[l]);return n?s.default:s})}}}("undefined"!=typeof self?self:global)(["1"],[],!1,function($__System){this.require,this.exports,this.module;$__System.register("2",[],function(_export,_context){"use strict";return{setters:[],execute:function(){class ContextQuery{constructor(query){this._onchange=null,this._listeners={},this._queries=this._breakQueriesDown(query),this._intervalID=void 0,this.context=query,this.matches=this._determineMatch(),this._registerListeners()}_registerListeners(){this.context.includes("light-intensity")&&window.addEventListener("devicelight",e=>{let normalised=e.value/10;this._performContextCheck("light-intensity",Math.round(normalised))}),this.context.includes("touch")&&this._performContextCheck("touch",!!("ontouchstart"in window||navigator.maxTouchPoints)),this._performContextCheck("time",60*(new Date).getHours()+(new Date).getMinutes()),this._intervalID=setInterval(()=>{this._performContextCheck("time",60*(new Date).getHours()+(new Date).getMinutes())},1e3);let acceleration=0;this.context.includes("motion-speed")&&window.addEventListener("devicemotion",function(e){let accel=Math.round(Math.sqrt(e.acceleration.y*e.acceleration.y+e.acceleration.x*e.acceleration.x));(accel>acceleration||0==accel)&&(acceleration=accel,this._performContextCheck("motion-speed",accel))}),(this.context.includes("charging-battery")||this.context.includes("battery"))&&navigator.getBattery().then(battery=>{this.context.includes("charging-battery")&&(this._performContextCheck("charging-battery",battery.charging),battery.addEventListener("chargingchange",()=>{this._performContextCheck("charging-battery",battery.charging)})),this.context.includes("battery")&&(this._performContextCheck("battery",100*battery.level),battery.addEventListener("levelchange",()=>{this._performContextCheck("battery",100*battery.level)}))})}_performContextCheck(fname,val){for(let i of window.contextFeatures)i.name==fname&&(i.value=val);this._determineMatch()}addEventListener(type,callback){type in this._listeners||(this._listeners[type]=[]),this._listeners[type].push(callback)}addListener(callback){this.addEventListener("change",callback)}removeEventListener(type,callback){if(!(type in this._listeners))return;let stack=this._listeners[type];for(let i in stack)if(console.log(stack[i]),stack[i].toString()===callback.toString())return void stack.splice(i,1)}removeListener(callback){this.removeEventListener("change",callback)}dispatchEvent(event){if(!(event.type in this._listeners))return!0;let stack=this._listeners[event.type];for(let elm of stack)elm.call(this,event);return!event.defaultPrevented}set onchange(callback){"function"==typeof callback&&(this.removeEventListener("change",this._onchange),this._onchange=callback,this.addEventListener("change",callback))}get onchange(){return this._onchange}_breakQueriesDown(context){function mixedSigns(arr,symbol,indc){if(2==arr.length){let tmpArr,tmpStr,left=!1;for(let idx in arr)arr[idx].includes(symbol)&&(tmpStr=arr[idx],arr.splice(idx,1),0==idx&&(left=!0));void 0!=tmpStr&&(tmpArr=tmpStr.split(symbol),left?(arr.unshift(tmpArr[1]),arr.unshift(tmpArr[0]),"&lt;"===symbol?indc.left=!0:indc.right=!0):(arr.push(tmpArr[0]),arr.push(tmpArr[1]),"&lt;"===symbol?indc.right=!0:indc.left=!0))}}let arrayOfContexts=[],or=/\s*,\s*|\s*or\s*/i,orArr=context.split(or);for(let y of orArr){let arrOfObj=[],andArr=y.split(/\s*and\s*/i);for(let j of andArr){let ra,objName,sr=j.substring(j.indexOf("(")+1,j.indexOf(")")),obj={},incdec={left:!1,right:!1};if(j.includes("<")||j.includes(">")){if(sr.includes("<")&&sr.includes(">"))return void console.error("you have mixed the greater than and less than symbol in an expression!");sr.includes("<")&&(sr.includes("<=")?mixedSigns(ra=sr.split("<="),"<",incdec):(ra=sr.split("<"),incdec={left:!0,right:!0}),2==ra.length?ra[0].includes("%")||!isNaN(ra[0])?(obj.min=parseFloat(ra[0]),obj.feature=ra[1].trim()):(obj.max=parseFloat(ra[1]),obj.feature=ra[0].trim()):(obj.feature=ra[1].trim(),obj.min=parseFloat(ra[0]),obj.max=parseFloat(ra[2])),(incdec.left||incdec.right)&&(obj.lt_gt=incdec),arrOfObj.push(obj)),sr.includes(">")&&(sr.includes(">=")?mixedSigns(ra=sr.split(">="),">",incdec):(ra=sr.split(">"),incdec={left:!0,right:!0}),2==ra.length?ra[0].includes("%")||!isNaN(ra[0])?(obj.max=parseFloat(ra[0]),obj.feature=ra[1].trim()):(obj.min=parseFloat(ra[1]),obj.feature=ra[0].trim()):(obj.feature=ra[1].trim(),obj.max=parseFloat(ra[0]),obj.min=parseFloat(ra[2])),(incdec.left||incdec.right)&&(obj.lt_gt=incdec),arrOfObj.push(obj))}else if(j.includes(":")){let inner,a,objVal;if(inner=j.substring(j.indexOf("(")+1,j.indexOf(")")),a=inner.split(/\s*:\s*/),objName=a[0].trim(),obj.feature=objName,objVal=parseFloat(a[1]),objName.includes("min-")||objName.includes("max-"))if(objName=objName.replace("min-",""),objName=objName.replace("max-",""),obj.feature=objName,0==arrOfObj.length)a[0].includes("min-")&&(obj.min=objVal),a[0].includes("max-")&&(obj.max=objVal),arrOfObj.push(obj);else for(let i of arrOfObj)i.feature!=obj.feature?(a[0].includes("min-")&&(obj.min=objVal),a[0].includes("max-")&&(obj.max=objVal),arrOfObj.push(obj)):(a[0].includes("min-")&&(i.min=objVal),a[0].includes("max-")&&(i.max=objVal));else obj.abs=objVal,arrOfObj.push(obj)}else{let inner=j.substring(j.indexOf("(")+1,j.indexOf(")"));inner&&(obj.feature=inner,obj.abs=!0,arrOfObj.push(obj))}}arrayOfContexts.push(arrOfObj)}return arrayOfContexts}_determineMatch(){let b=!1;for(let j of this._queries){let b2=!0;for(let k of j){let min=Number.NEGATIVE_INFINITY,max=Number.POSITIVE_INFINITY;for(let feature of window.contextFeatures)feature.name===k.feature&&(k.hasOwnProperty("abs")?Number.isInteger(k.abs)?feature.value!=k.abs&&(b2=!1):feature.value||(b2=!1):(k.hasOwnProperty("min")&&(min=k.min),k.hasOwnProperty("max")&&(max=k.max),k.hasOwnProperty("lt_gt")&&(k.lt_gt.left&&++min,k.lt_gt.right&&--max),min==-1/0&&max==1/0||(feature.value<min||max<feature.value)&&(b2=!1)))}b2&&(b=!0)}if(b!=this.matches){if(void 0==this.matches)return b;this.matches=b,this.dispatchEvent(new CustomEvent("change",{detail:{matches:b,target:this}}))}}}_export("default",ContextQuery),window.matchContext=function(expression){let o=new ContextQuery(expression);return console.log(o),o},window.contextFeatures=[{name:"light-intensity",value:null,supported:"ondevicelight"in window},{name:"motion-speed",value:null,supported:"ondevicemotion"in window},{name:"touch",value:null,supported:!!("ontouchstart"in window||navigator.maxTouchPoints)},{name:"time",value:null,supported:!0},{name:"battery",value:null,supported:!!navigator.getBattery},{name:"charging-battery",value:null,callback:!!navigator.getBattery}]}}}),$__System.register("3",[],function(_export,_context){"use strict";return{setters:[],execute:function(){class ContextStyle extends HTMLElement{constructor(){super(),this._arrayOfQueries=[],this._host=document.querySelector("html"),this._head=document.querySelector("head"),this._contextQueryObjectList=[]}connectedCallback(){this.style.display="none",void 0!=this.parentNode.host&&(this.parentNode.host.shadowRoot.querySelector("slot")||(this._host=this.parentNode.host,this._head=this._host.shadowRoot)),this.getHrefAttr()}disconnectedCallback(){for(let i in this._contextQueryObjectList)void 0!=this._contextQueryObjectList[i]._intervalID&&clearInterval(this._contextQueryObjectList[i]._intervalID),this._contextQueryObjectList[i]=null,delete this._contextQueryObjectList[i];for(let j of this._arrayOfQueries)this._host.classList.remove(j.class);this._contextQueryObjectList.length=0}getContent(attr){let inner=this.innerHTML;""!=inner.trim()?(inner=inner.replace(/&gt;/g,">").replace(/&lt;/g,"<"),this.instantiateContextQueryObjects(inner.trim(),attr)):console.error("Context-Styles have not been declared, please use the href attribute or write them directly in the context-style tag.")}getHrefAttr(){let attr=!1;this.hasAttribute("context")&&""!=this.getAttribute("context")&&(attr=this.getAttribute("context")),this.hasAttribute("href")&&""!=this.getAttribute("href")?this.getURL(this.getAttribute("href")).then(response=>{this.instantiateContextQueryObjects(response,attr)},error=>{console.error("Failed!",error)}):this.getContent(attr)}getURL(url){return new Promise(function(resolve,reject){var req=new XMLHttpRequest;req.open("GET",url),req.onload=function(){200==req.status?resolve(req.response):reject(Error(req.statusText))},req.onerror=function(){reject(Error("Network Error"))},req.send()})}instantiateContextQueryObjects(str,attr){this.factoriseContextQueries(str,attr);for(let contextQuery of this._arrayOfQueries){const cssClass="css-ctx-queries-"+(+new Date).toString(36);contextQuery.class=cssClass;let cqo=window.matchContext(contextQuery.expression),css="";cqo.onchange=(e=>{void 0!=e&&console.log(e),cqo.matches?this._host.classList.contains(cssClass)||this._host.classList.add(cssClass):this._host.classList.contains(cssClass)&&this._host.classList.remove(cssClass)}),cqo.onchange(),this._contextQueryObjectList.push(cqo);for(let style of contextQuery.styles){let key=style.selector;void 0!=this._host.shadowRoot?this._host.shadowRoot.querySelector("slot")?css+="."+cssClass+" "+this._host.localName+" "+key.replace("&gt;",">")+"{"+style.properties+"}":css+=":host"==key?":host(."+cssClass+") {"+style.properties+"}":":host(."+cssClass+") "+key.replace("&gt;",">")+"{"+style.properties+"}":css+="html"===key?key+"."+cssClass+"{"+style.properties+"}":"."+cssClass+" "+key.replace("&gt;",">")+"{"+style.properties+"}"}if(this._head.querySelector("#cssCtxQueriesStyleTag"))this._head.querySelector("#cssCtxQueriesStyleTag").appendChild(document.createTextNode(css));else{let style=document.createElement("style");style.id="cssCtxQueriesStyleTag",style.appendChild(document.createTextNode(css)),this._head.appendChild(style)}}}findClosingBracket(brackets,str){let c=str.indexOf(brackets[0],str.indexOf("@context")),i=1;for(;i>0;){let b=str[++c];b==brackets[0]?i++:b==brackets[1]&&i--}return c}factoriseContextQueries(str,attr){if(str.includes("@context")){let sbstrng=str.substring(str.indexOf("@context"),this.findClosingBracket("{}",str)+1),str2=str.replace(sbstrng,"");str2=str2.trim(),this._arrayOfQueries.push(sbstrng),this.factoriseContextQueries(str2,attr)}else{0!=attr&&this._arrayOfQueries.push("@context "+attr+" {"+str+"}");let newArrayOfQueries=[];for(let elm of this._arrayOfQueries){let expression=elm.substring(8,elm.indexOf("{")),arrayOfSelectors=[],singleStyles=elm.substring(elm.indexOf("{")+1,elm.lastIndexOf("}")).split(/\s*}\s*/);for(let z of singleStyles){let classes,attrs,classArr;classes=z.substring(0,z.indexOf("{")),attrs=z.substring(z.indexOf("{")+1),classArr=classes.split(/\s*,\s*/);for(let sc of classArr){let obj={selector:sc.trim(),properties:attrs.trim()};""==obj.selector&&""===obj.properties||arrayOfSelectors.push(obj)}}newArrayOfQueries.push({expression:expression.trim(),styles:arrayOfSelectors})}if(0!=attr){let globalQuery=newArrayOfQueries[newArrayOfQueries.length-1].expression;for(let i=0;i<newArrayOfQueries.length-1;i++)newArrayOfQueries[i].expression+=" and "+globalQuery}this._arrayOfQueries=[];for(let i of newArrayOfQueries)i.styles.length>0&&this._arrayOfQueries.push(i)}}}_export("default",ContextStyle),document.addEventListener("DOMContentLoaded",function(){window.customElements.define("context-style",ContextStyle)})}}}),$__System.register("1",["2","3"],function(_export,_context){"use strict";var ContextQuery,ContextStyle;return{setters:[function(_){ContextQuery=_.default},function(_2){ContextStyle=_2.default}],execute:function(){_export("ContextQuery",ContextQuery),_export("ContextStyle",ContextStyle)}}})})(function(factory){"function"==typeof define&&define.amd?define([],factory):"object"==typeof module&&module.exports&&"function"==typeof require?module.exports=factory():cq=factory()});