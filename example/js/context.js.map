{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/context-query.js","webpack:///./src/context-style.js","webpack:///./src/context.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","window","contextFeatures","supported","navigator","maxTouchPoints","ContextQuery","[object Object]","query","this","_onchange","_listeners","_queries","_breakQueriesDown","_intervalID","context","matches","_determineMatch","_registerListeners","feature","includes","addEventListener","e","normalised","_performContextCheck","Math","round","Date","getHours","getMinutes","setInterval","acceleration","accel","sqrt","y","x","getBattery","then","battery","level","charging","fname","val","type","callback","push","stack","console","log","toString","splice","removeEventListener","event","elm","defaultPrevented","onchange","mixedSigns","arr","symbol","left","right","length","tmpArr","tmpStr","idx","undefined","split","unshift","findClosingBracket","start","str","indexOf","b","tree","queries","createQueryTreeRecursively","obj","q","substring","replace","trim","operator","ra","objName","incdec","prcnt","objct","lt","gt","lteq","gteq","negate","error","isNaN","min","parseFloat","max","lt_gt","a","objVal","abs","evaluateQueriesRecursively","tmp","b1","Number","NEGATIVE_INFINITY","POSITIVE_INFINITY","isInteger","Infinity","dispatchEvent","CustomEvent","detail","target","matchContext","expression","ContextStyle","HTMLElement","super","_arrayOfQueries","_host","document","querySelector","_head","_contextQueryObjectList","style","display","parentNode","host","shadowRoot","getHrefAttr","clearInterval","j","classList","remove","class","attr","inner","innerHTML","instantiateContextQueryObjects","hasAttribute","getAttribute","getURL","response","getContent","url","Promise","resolve","reject","req","XMLHttpRequest","open","onload","status","Error","statusText","onerror","send","factoriseContextQueries","contextQuery","cssClass","cqo","css","contains","add","styles","selector","localName","properties","appendChild","createTextNode","createElement","id","brackets","sbstrng","str2","newArrayOfQueries","arrayOfSelectors","singleStyles","lastIndexOf","z","classes","attrs","classArr","sc","globalQuery","customElements","define","__webpack_exports__"],"mappings":"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","file":"context.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\r\n * \r\n */\r\n // new features structure\r\nwindow.contextFeatures = [\r\n    { name: 'light-intensity', value: null, supported: 'ondevicelight' in window ? true : false },\r\n    { name: 'motion-speed', value: null, supported: 'ondevicemotion' in window ? true : false },\r\n    { name: 'touch', value: null, supported: 'ontouchstart' in window || navigator.maxTouchPoints ? true : false  },\r\n    { name: 'time', value: null, supported: true },\r\n    { name: 'battery', value: null, supported: 'getBattery' in navigator ? true : false },\r\n    { name: 'charging-battery', value: null, supported: 'getBattery' in navigator ? true : false }\r\n];\r\n\r\nexport default class ContextQuery {\r\n    constructor(query) {\r\n        // 'Private'\r\n        this._onchange = null;\r\n        this._listeners = {};\r\n        this._queries = this._breakQueriesDown(query);\r\n        this._intervalID = {};       \r\n        // 'Public'\r\n        this.context = query;\r\n        this.matches = this._determineMatch();\r\n        // attach event listeners\r\n        this._registerListeners();\r\n    }\r\n\r\n    _registerListeners() {\r\n        for( let feature of window.contextFeatures ) {\r\n            if ( feature.supported && this.context.includes(feature.name)) {\r\n                switch( feature.name ) {\r\n                    case 'light-intensity':\r\n                        window.addEventListener('devicelight', (e) => {      \r\n                            let normalised = e.value / 10; // normalise range from 0 to 100, max value on nexus 4 is 1000\r\n                            this._performContextCheck('light-intensity',Math.round(normalised));\r\n                        });\r\n                        break;\r\n                    case 'touch':\r\n                        this._performContextCheck('touch', ('ontouchstart' in window || navigator.maxTouchPoints)?true:false);\r\n                        break;\r\n                    case 'time':\r\n                        this._performContextCheck('time',(new Date().getHours() * 60) +  new Date().getMinutes());\r\n                        this._intervalID = setInterval(() => {\r\n                            this._performContextCheck('time',(new Date().getHours() * 60) +  new Date().getMinutes());\r\n                        },1000);\r\n                        break;\r\n                    case 'motion-speed':\r\n                        let acceleration = 0;\r\n                        window.addEventListener('devicemotion', function(e) {\r\n                            let accel = Math.round(Math.sqrt(e.acceleration.y*e.acceleration.y + e.acceleration.x*e.acceleration.x));   \r\n                            if (accel > acceleration || accel == 0) {\r\n                                acceleration = accel;\r\n                                this._performContextCheck('motion-speed', accel);\r\n                            }\r\n                        });\r\n                        break;\r\n                    case 'battery':\r\n                        navigator.getBattery().then((battery) => {\r\n                            this._performContextCheck('battery', battery.level * 100 );     \r\n                            battery.addEventListener('levelchange', () => {\r\n                                this._performContextCheck('battery', battery.level * 100 );\r\n                            });\r\n\r\n                        });\r\n                        break;\r\n                    case 'charging-battery':\r\n                        navigator.getBattery().then((battery) => {\r\n                            // Perform check on resolved promise then add change listener\r\n                            this._performContextCheck('charging-battery',battery.charging);\r\n                            battery.addEventListener('chargingchange',() => {         \r\n                                this._performContextCheck('charging-battery',battery.charging);\r\n                            });   \r\n                        });\r\n                        break;\r\n                }\r\n            }   \r\n        }\r\n        \r\n    }\r\n\r\n    /**   \r\n     * @param {string} fname the name of the feature\r\n     * @param {number} val the new numeric value\r\n     */\r\n    _performContextCheck(fname,val) {\r\n        // update the values passed by the listeners of this._registerListeners() in the window.contextFeatures object\r\n        for(let i of window.contextFeatures) {\r\n            if(i.name == fname) {\r\n                i.value = val;\r\n            }\r\n        }\r\n        this._determineMatch();\r\n    }\r\n\r\n    /**   \r\n     * @param {string} type \r\n     * @param {function} callback \r\n     */\r\n\r\n    addEventListener(type, callback) {\r\n        if (!(type in this._listeners)) {\r\n            this._listeners[type] = [];\r\n        }\r\n        this._listeners[type].push(callback);\r\n    };\r\n\r\n    /** \r\n     * @param {function} callback \r\n     */\r\n\r\n    addListener(callback) {\r\n        this.addEventListener(\"change\", callback);\r\n    }\r\n\r\n    /**   \r\n     * @param {string} type \r\n     * @param {function} callback \r\n     */\r\n\r\n    removeEventListener(type, callback) {\r\n        if (!(type in this._listeners)) {\r\n            return;\r\n        }\r\n        let stack = this._listeners[type];\r\n\r\n        for (let i in stack) {\r\n            console.log(stack[i]);  \r\n            if (stack[i].toString() === callback.toString()){\r\n                stack.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    };\r\n\r\n    /** \r\n     * @param {function} callback \r\n     */\r\n\r\n    removeListener(callback) {\r\n        this.removeEventListener(\"change\", callback)\r\n    }\r\n\r\n    /** \r\n     * @param {CustomEvent} event \r\n     */\r\n\r\n    dispatchEvent(event) {\r\n        if (!(event.type in this._listeners)) {\r\n            return true;\r\n        }\r\n        let stack = this._listeners[event.type];\r\n\r\n        //event.target = this;\r\n        for (let elm of stack) {\r\n            elm.call(this, event);\r\n        }\r\n        return !event.defaultPrevented;\r\n    };\r\n\r\n    /** \r\n     * @param {function} callback \r\n     */\r\n\r\n    set onchange(callback) {    \r\n        if(typeof callback == \"function\") {\r\n            this.removeEventListener(\"change\", this._onchange);\r\n            this._onchange = callback;\r\n            this.addEventListener(\"change\", callback);\r\n        } \r\n    } \r\n\r\n    get onchange() {\r\n        return this._onchange;\r\n    }\r\n\r\n\r\n    /**   \r\n     * @param {string} context \r\n     */\r\n    _breakQueriesDown(context) {\r\n        /**\r\n         * @param {array} arr the resulting array after having splitted the query using <= or >=\r\n         * @param {string} symbol the character to look up for in the passed array, either < or >\r\n         */\r\n        function mixedSigns(arr,symbol) {\r\n            let o = {left:false,right:false};\r\n            if (arr.length == 2) {\r\n                let left = false, tmpArr, tmpStr;\r\n                for (let idx in arr) {            \r\n                    // check if symbol is present\r\n                    if(arr[idx].includes(symbol)) {\r\n                        tmpStr = arr[idx];\r\n                        arr.splice(idx,1);\r\n                        if(idx==0) {\r\n                            left = true;\r\n                        } \r\n                    }\r\n                }\r\n                // if tmpStr has been assigned value\r\n                if(tmpStr != undefined) {\r\n                    tmpArr = tmpStr.split(symbol);\r\n                    if (left) {\r\n                        arr.unshift(tmpArr[1]);\r\n                        arr.unshift(tmpArr[0]);\r\n                        if( symbol === '<') {\r\n                            o.left = true;\r\n                        } else {\r\n                            o.right = true;\r\n                        }\r\n                        \r\n                    } else {\r\n                        arr.push(tmpArr[0]);\r\n                        arr.push(tmpArr[1]);\r\n                        if( symbol === '<') {\r\n                            o.right = true;\r\n                        } else {\r\n                            o.left = true;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return o;\r\n        }\r\n\r\n        /**\r\n         * @param {string} brackets the type of brackets as pair [],{},()\r\n         * @param {string} str the string where the brackets are to be found \r\n         */\r\n\r\n        function findClosingBracket(start, str){\r\n            let c = str.indexOf('(', start);\r\n            let i = 1;\r\n            while (i > 0) {\r\n                let b = str[++c];\r\n                if (b == '(') {\r\n                    i++;\r\n                }\r\n                else if (b == ')') {\r\n                    i--;\r\n                }\r\n            }\r\n            return c;\r\n        }\r\n\r\n        let tree = { queries: [] };\r\n\r\n        /**\r\n         * @param {object} obj an object representing all relations between the queries of which the context is composed \r\n         * such an object has the following structure:\r\n         * {\r\n         *  operator: 'and' | 'or' // optional: the operator combining two or more queries\r\n         *  negate: true // optional: whether the expression has been prefixed with 'not'\r\n         *  queries: [ // array of objects\r\n         *      { // an object representing a query\r\n         *          context: '120 < time < 600', // the query\r\n         *          feature: 'time', // the name of the feature\r\n         *          lt_gt: { // optional when using < or >\r\n         *              left: true | false,\r\n         *              right: true | false\r\n         *          },\r\n         *          max: 600, // optional: the max value specified in the query\r\n         *          min: 120, // optional: the min value specified in the query\r\n         *          abs: true | 'string' // optional: whether the query has an absolute value \r\n         *      },\r\n         *      { // an object with the same structure as its parent\r\n         *          operator: 'and',\r\n         *          queries: [\r\n         *              ...\r\n         *          ]\r\n         *      }\r\n         *  ]\r\n         * }\r\n         * @param {string} context the composed context \r\n         */\r\n\r\n        function createQueryTreeRecursively(obj,context) {\r\n            let q = '', idx = context.indexOf('(');\r\n\r\n            // check if the expression has prefix 'not', if so set idx to 0 \r\n            if(context.substring(idx - 3,idx) === 'not') {\r\n                idx = idx - 3;\r\n            }\r\n            // if idx != 0 we're dealing with an operator\r\n            if(idx != 0) {\r\n                q = context.substring(0, idx);    \r\n            } else  {\r\n                q = context.substring(idx, findClosingBracket(idx,context) + 1);\r\n            }\r\n            // replace the substring \r\n            context = context.replace(q,'');\r\n            q = q.trim();\r\n            \r\n            if(q !== ''){ \r\n                if( q == 'or' || q == 'and') { \r\n                    obj.operator = q;\r\n                } else {\r\n                    if(!q.includes('and') && !q.includes('or') ) {\r\n                        let ra, prcnt = '%', objct = {}, objName, incdec, lt = '<', gt = '>', lteq = '<=', gteq = '>=';\r\n                        if(q.substring(q.indexOf('(') - 3,q.indexOf('(')) === 'not') {\r\n                            objct.negate = true;\r\n                        }\r\n                        objct.context = q.substring(q.indexOf('(') + 1, q.indexOf(')'));\r\n                        if( objct.context.includes(lt) || objct.context.includes(gt) ) {               \r\n                            if (objct.context.includes(lt) && objct.context.includes(gt)) {\r\n                                console.error('you have mixed the greater than and less than symbol in an expression!');\r\n                                return;\r\n                            }\r\n                            if (objct.context.includes(lt)) {\r\n                                if (objct.context.includes(lteq)) {\r\n                                    ra = objct.context.split(lteq);\r\n                                    incdec = mixedSigns(ra,lt);\r\n                                } else {\r\n                                    ra = objct.context.split(lt);\r\n                                    incdec = {left:true,right:true};   \t\r\n                                }  \r\n                                if(ra.length == 2) {\r\n                                    if(ra[0].includes(prcnt) || !isNaN(ra[0])) {\r\n                                        objct.min = parseFloat(ra[0]); \r\n                                        objct.feature = ra[1].trim();\r\n                                    } else {\r\n                                        objct.max = parseFloat(ra[1]); \r\n                                        objct.feature = ra[0].trim();                                \r\n                                    }\r\n                                } else {\r\n                                    objct.feature = ra[1].trim();\r\n                                    objct.min = parseFloat(ra[0]);\r\n                                    objct.max = parseFloat(ra[2]);\r\n                                }\r\n                                \r\n                                if( incdec.left || incdec.right ) {\r\n                                    objct.lt_gt = incdec;\r\n                                }\r\n                                q = {};                 \r\n                                q = objct;\r\n                            }\r\n                            if (objct.context.includes(gt)) {\r\n                                if (objct.context.includes(gteq)) {\r\n                                    ra = objct.context.split(gteq);\r\n                                    incdec = mixedSigns(ra,gt);\r\n                                } else {\r\n                                    ra = objct.context.split(gt);\r\n                                    incdec = {left:true,right:true};\r\n                                } \r\n                                if(ra.length == 2) {\r\n                                    if(ra[0].includes(prcnt) || !isNaN(ra[0])) {\r\n                                        objct.max = parseFloat(ra[0]);\r\n                                        objct.feature = ra[1].trim();\r\n                                    } else {\r\n                                        objct.min = parseFloat(ra[1]);\r\n                                        objct.feature = ra[0].trim();\r\n                                    }\r\n                                    \r\n                                } else {\r\n                                    objct.feature = ra[1].trim();\r\n                                    objct.max = parseFloat(ra[0]);\r\n                                    objct.min = parseFloat(ra[2]);\r\n                                }\r\n                                if( incdec.left || incdec.right ) {\r\n                                    objct.lt_gt = incdec;\r\n                                }\r\n                                q = {};                 \r\n                                q = objct;\r\n                                \r\n                            }\r\n                        } else if( objct.context.includes(':')) {                \r\n                            let a, objVal;          \r\n                            a = objct.context.split(/\\s*:\\s*/);\r\n                            objName = a[0].trim();\r\n                            objct.feature = objName;\r\n                            objVal = parseFloat(a[1]);\r\n                            \r\n                            if( objName.includes('min-') || objName.includes('max-')) {\r\n                                objName = objName.replace('min-','');\r\n                                objName = objName.replace('max-','');\r\n                                objct.feature = objName;\r\n                                if(a[0].includes('min-')) {\r\n                                    objct.min = objVal;\r\n                                }\r\n                                if(a[0].includes('max-')) {\r\n                                    objct.max = objVal;\r\n                                }\r\n                                q = {};                 \r\n                                q = objct;\r\n                                 \r\n                            } else {\r\n                                objct.abs = objVal;\r\n                                q = {};                 \r\n                                q = objct;\r\n                            }\r\n                        } else {\r\n                            if(objct.context) {\r\n                                objct.feature = objct.context;\r\n                                objct.abs = true;\r\n                                q = {};             \r\n                                q = objct;\r\n                            }  \r\n                        }\r\n                    }\r\n                    obj.queries.push(q);\r\n                }\r\n                // carry on recursively with the rest of the string\r\n                createQueryTreeRecursively(obj,context);\r\n            } else {\r\n                for(let i in obj.queries){\r\n                    if(typeof obj.queries[i] === 'string') {\r\n                        context = obj.queries[i];\r\n                        obj.queries[i] = { queries: [] };\r\n                        if(context.substring(context.indexOf('(') - 3,context.indexOf('(')) === 'not') {\r\n                            context = context.replace('not','');\r\n                            obj.queries[i].negate = true;\r\n                        }\r\n                        context = context.substring(context.indexOf('(') + 1, findClosingBracket(context.indexOf('('),context));\r\n                        \r\n                        createQueryTreeRecursively(obj.queries[i],context);\r\n                    }       \r\n                }\r\n            }\r\n        }\r\n\r\n        createQueryTreeRecursively(tree,context.trim());\r\n\r\n        return tree;\r\n        \r\n    }\r\n\r\n    _determineMatch() {\r\n        /** \r\n        * @param {object} obj the object representing the combined queries in a tree-like structure  \r\n        */\r\n        function evaluateQueriesRecursively(obj) {\r\n            let tmp, operator;\r\n\r\n            // check if the combined query has been prefixed with 'not', if so invert the operators\r\n            if(obj.hasOwnProperty('negate')) {\r\n                if(obj.operator === 'and') {\r\n                    operator = 'or';\r\n                } else if(obj.operator === 'or') {\r\n                    operator = 'and';\r\n                }\r\n            } else {\r\n                operator = obj.operator;\r\n            }\r\n\r\n            for(let q of obj.queries) {\r\n                if(!q.hasOwnProperty('queries')) {      \r\n                    let b1 = true, min = Number.NEGATIVE_INFINITY, max = Number.POSITIVE_INFINITY; \r\n                    for(let feature of window.contextFeatures ){\r\n                        if(feature.name === q.feature) {\r\n                            // Compare to values stored in Features object\r\n                            if(feature.supported) {\r\n                                // has an unique value either numeric or boolean\r\n                                if(q.hasOwnProperty('abs')) {\r\n                                    if(Number.isInteger(q.abs)) {\r\n                                        if(feature.value != q.abs) {\r\n                                            b1 = false;\r\n                                        } \r\n                                    } else {\r\n                                        if(!feature.value) {\r\n                                            b1 = false;\r\n                                        } \r\n                                    }\r\n                                } else {\r\n                                    // Value is in range\r\n                                    if(q.hasOwnProperty('min')) {\r\n                                        min = q.min;\r\n                                    }         \r\n                                    if(q.hasOwnProperty('max')) {\r\n                                        max = q.max;\r\n                                    }\r\n                                    if(q.hasOwnProperty('lt_gt')) {\r\n                                        if(q.lt_gt.left) {\r\n                                            ++min;\r\n                                        } \r\n                                        if(q.lt_gt.right) {\r\n                                            --max;\r\n                                        }\r\n                                    }\r\n                                    if(min != -Infinity || max != Infinity) {                                  \r\n                                        if ( feature.value < min || max < feature.value) {\r\n                                            b1 = false;\r\n                                        }        \r\n                                    }\r\n                                }\r\n                                if(q.hasOwnProperty('negate')) {\r\n                                    b1 = !b1;\r\n                                }\r\n                            } else {\r\n                                b1 = false;\r\n                            }\r\n                        }  \r\n                    }\r\n                    if(obj.hasOwnProperty('negate')) {\r\n                        b1 = !b1;\r\n                    }\r\n                    \r\n                    if (obj.queries.indexOf(q) === 0) {\r\n                        tmp = b1;\r\n                    } else {\r\n                        if(operator === 'and') {\r\n                            tmp = tmp && b1;\r\n                        }\r\n                        if(operator === 'or') {\r\n                            tmp = tmp || b1;\r\n                        }\r\n                    }\r\n                  \r\n                } else {\r\n                    if (obj.queries.indexOf(q) !== 0){\r\n                        if(operator === 'and') {\r\n                            tmp = tmp && evaluateQueriesRecursively(q);\r\n                        }\r\n                        if(operator === 'or') {\r\n                            tmp = tmp || evaluateQueriesRecursively(q);\r\n                        }\r\n                    } else {\r\n                        tmp = evaluateQueriesRecursively(q);\r\n                    }   \r\n                }\r\n            }\r\n            return tmp;\r\n        }\r\n\r\n        let b = evaluateQueriesRecursively(this._queries);\r\n\r\n        if( b != this.matches ) {            \r\n            if(this.matches == undefined) {\r\n                return b;\r\n            } else {\r\n                this.matches = b;\r\n                this.dispatchEvent(new CustomEvent(\"change\", { detail: { matches: b, target: this }}));\r\n            }           \r\n        }\r\n        \r\n    }\r\n}\r\n\r\n// matchContext function to instantiate ContextQueryList Object with -- let varname = window.matchContext(\"(touch)\") -- \r\nwindow.matchContext = function(expression) {\r\n    let o = new ContextQuery(expression);\r\n    //console.log(o);            \r\n    return o;\r\n}","/**\r\n * \r\n */\r\nexport default class ContextStyle extends HTMLElement {\r\n\r\n    constructor() {\r\n        super();\r\n        this._arrayOfQueries = [];\r\n        this._host = document.querySelector(\"html\");\r\n        this._head = document.querySelector('head');\r\n        this._contextQueryObjectList = [];\r\n    }\r\n\r\n    connectedCallback() {\r\n        this.style.display = 'none';\r\n        if(this.parentNode.host != undefined) {\r\n            if(!this.parentNode.host.shadowRoot.querySelector('slot')) {\r\n                this._host = this.parentNode.host;\r\n                this._head = this._host.shadowRoot;\r\n            }\r\n        }\r\n        this.getHrefAttr();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        for(let i in this._contextQueryObjectList) {\r\n            if(this._contextQueryObjectList[i]._intervalID != undefined) {\r\n                clearInterval(this._contextQueryObjectList[i]._intervalID);\r\n            }\r\n            this._contextQueryObjectList[i] = null;\r\n            delete this._contextQueryObjectList[i];\r\n        }\r\n        for(let j of this._arrayOfQueries) {\r\n            this._host.classList.remove(j.class);\r\n        }\r\n        this._contextQueryObjectList.length = 0;\r\n        //console.log(this._contextQueryObjectList);\r\n    }\r\n\r\n    /**\r\n     * @param {string} attr - the query from the \"context\" attribute   \r\n     */\r\n    getContent(attr) {\r\n        let inner = this.innerHTML;  \r\n        if(inner.trim() != ''){\r\n            inner = inner.replace(/&gt;/g, '>').replace(/&lt;/g, '<');\r\n            this.instantiateContextQueryObjects( inner.trim(), attr );\r\n        } else {\r\n            console.error('Context-Styles have not been declared, please use the href attribute or write them directly in the context-style tag.');\r\n        }\r\n                \r\n    }\r\n\r\n    getHrefAttr() {\r\n        let attr = false;\r\n        if(this.hasAttribute('context') && this.getAttribute('context') != \"\") {\r\n            attr = this.getAttribute('context'); \r\n        } \r\n        if(this.hasAttribute('href') && this.getAttribute('href') != \"\") {\r\n            this.getURL(this.getAttribute('href')).then((response) => {\r\n                this.instantiateContextQueryObjects(response, attr);\r\n                //this.content(attr);\r\n            }, (error) => {\r\n                console.error(\"Failed!\", error);\r\n            });\r\n        } else {\r\n            //console.log('href empty or non existent');\r\n            this.getContent(attr);\r\n        }   \r\n    }\r\n\r\n    /**   \r\n     * @param {string} url - the link to an external context query sheet\r\n     */\r\n\r\n    getURL(url) {\r\n        return new Promise(function(resolve, reject) {\r\n            var req = new XMLHttpRequest();\r\n            req.open('GET', url);\r\n            req.onload = function() {\r\n                if (req.status == 200) {\r\n                    resolve(req.response);\r\n                }\r\n                else {\r\n                    reject(Error(req.statusText));\r\n                }\r\n            };\r\n            req.onerror = function() {\r\n                reject(Error(\"Network Error\"));\r\n            };\r\n            req.send();\r\n        });\r\n    }\r\n    \r\n    /**\r\n     * @param {string} str the styles found inside the <context-style> custom element\r\n     * @param {string} attr the query of the \"context\" attribute \r\n     */\r\n\r\n    instantiateContextQueryObjects(str,attr) {\r\n        this.factoriseContextQueries(str,attr);\r\n        for(let contextQuery of this._arrayOfQueries) {\r\n            // Generate unique class;\r\n            // unary operator in +new Date equivalent to Number(new Date)\r\n            const cssClass = 'css-ctx-queries-' + (+new Date).toString(36) + this._arrayOfQueries.indexOf(contextQuery);\r\n            contextQuery.class = cssClass;\r\n            // Instantiate Object with new constructor\r\n            let cqo = window.matchContext(contextQuery.expression), css = \"\";\r\n            // Define a callback on change\r\n            cqo.onchange = (e) => {\r\n                if(e != undefined) {\r\n                    console.log(e);\r\n                }\r\n                if( cqo.matches ) {\r\n                    if(!this._host.classList.contains(cssClass)){                   \r\n                        this._host.classList.add(cssClass);\r\n                    }       \r\n                } else  {\r\n                    if(this._host.classList.contains(cssClass)) {         \r\n                        this._host.classList.remove(cssClass);\r\n                    }             \r\n                }\r\n            }\r\n            // trigger the callback for the first time\r\n            cqo.onchange();\r\n\r\n            this._contextQueryObjectList.push(cqo);\r\n            \r\n            for(let style of contextQuery.styles) {\r\n                let key = style.selector;\r\n                if(this._host.shadowRoot != undefined) {\r\n                    if(!this._host.shadowRoot.querySelector('slot')) {\r\n                        if(key == ':host') {\r\n                            css += ':host(.' + cssClass + ') ' + '{' + style.properties + '}'; \r\n                        } else {\r\n                            css += ':host(.' + cssClass + ') ' + key.replace('&gt;','>') + '{' + style.properties + '}';                            \r\n                        }\r\n                    } else {\r\n                        css += '.' + cssClass + ' ' + this._host.localName + ' ' + key.replace('&gt;','>') + '{' + style.properties + '}'; \r\n                    }\r\n                } else {\r\n                    if(key === 'html') {\r\n                        css += key +  '.' + cssClass + '{' + style.properties + '}';\r\n                    } else {\r\n                        css += '.' + cssClass + ' ' + key.replace('&gt;','>') + '{' + style.properties + '}';\r\n                    }\r\n                }  \r\n            }\r\n            \r\n            if(this._head.querySelector('#cssCtxQueriesStyleTag')) {\r\n                this._head.querySelector('#cssCtxQueriesStyleTag').appendChild(document.createTextNode(css));\r\n            } else {\r\n                let style = document.createElement('style');\r\n                style.id = 'cssCtxQueriesStyleTag';\r\n                style.appendChild(document.createTextNode(css));\r\n                this._head.appendChild(style);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {string} brackets the type of brackets as pair [],{},()\r\n     * @param {string} str the string where the brackets are to be found \r\n     */\r\n\r\n    findClosingBracket(brackets, str){\r\n        let c = str.indexOf(brackets[0], str.indexOf('@context'));\r\n        let i = 1;\r\n        while (i > 0) {\r\n            let b = str[++c];\r\n            if (b == brackets[0]) {\r\n                i++;\r\n            }\r\n            else if (b == brackets[1]) {\r\n                i--;\r\n            }\r\n        }\r\n        return c;\r\n    }\r\n\r\n    /**\r\n     * @param {string} str - the content of the <context-style> custom element\r\n     * @param {string} attr - the content of the context attribute, false if the context attribute is empty\r\n     */\r\n\r\n    factoriseContextQueries(str, attr) { \r\n        if(str.includes('@context')){\r\n            let sbstrng = str.substring(str.indexOf(\"@context\"), this.findClosingBracket('{}',str) + 1);\r\n            let str2 = str.replace(sbstrng,'');\r\n            str2 = str2.trim();\r\n            this._arrayOfQueries.push(sbstrng);\r\n            this.factoriseContextQueries(str2, attr);\r\n        } else {\r\n            // push the query from the context attribute into _arrayOfQueries\r\n            if(attr != false) {\r\n                this._arrayOfQueries.push('@context '+ attr +' {'+ str + '}');\r\n            }\r\n            let newArrayOfQueries = [];\r\n            for (let elm of this._arrayOfQueries) {\r\n                let expression = elm.substring(8, elm.indexOf('{'));\r\n                let styles = elm.substring(elm.indexOf('{') + 1,elm.lastIndexOf('}'));\r\n                let arrayOfSelectors = [], singleStyles = styles.split(/\\s*}\\s*/);\r\n                for (let z of singleStyles){\r\n                    let classes, attrs, classArr; \r\n                    classes = z.substring(0,z.indexOf(\"{\"));\r\n                    attrs =  z.substring(z.indexOf(\"{\") + 1);                            \r\n                    classArr = classes.split(/\\s*,\\s*/);\r\n                    for(let sc of classArr) {\r\n                        let obj = { selector: sc.trim(), properties: attrs.trim() };\r\n                        if(obj.selector != \"\" || obj.properties !== \"\") {\r\n                            arrayOfSelectors.push(obj);\r\n                        }\r\n                    }\r\n                }\r\n                \r\n                newArrayOfQueries.push({expression:expression.trim(),styles:arrayOfSelectors});  \r\n            }\r\n            \r\n            // factorise all objects in _arrayOfQueries only if there's a global query and more than one query in total \r\n            if(attr != false) {\r\n                let globalQuery = newArrayOfQueries[newArrayOfQueries.length - 1].expression;\r\n                if(globalQuery.includes('or') || globalQuery.includes(',')) {\r\n                    globalQuery = '(' + globalQuery + ')';\r\n                }\r\n                for(let i = 0; i < newArrayOfQueries.length - 1; i++) {\r\n                    if(newArrayOfQueries[i].expression.includes('or') || newArrayOfQueries[i].expression.includes(',')) {\r\n                        newArrayOfQueries[i].expression = '(' + newArrayOfQueries[i].expression + ')'; \r\n                    } \r\n                    newArrayOfQueries[i].expression += ' and ' + globalQuery;\r\n                }\r\n                \r\n            }\r\n            this._arrayOfQueries = [];\r\n            // reorganise arrayOfQueries\r\n            for (let i of newArrayOfQueries) {\r\n                if(i.styles.length > 0) {\r\n                    this._arrayOfQueries.push(i);\r\n                }\r\n            }\r\n        }      \r\n    }\r\n    \r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n    window.customElements.define('context-style', ContextStyle);\r\n});\r\n","import ContextQuery from './context-query';\r\nimport ContextStyle from './context-style';\r\n\r\nexport {ContextQuery, ContextStyle};"],"sourceRoot":""}